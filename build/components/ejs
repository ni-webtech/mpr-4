#
#   Ejs
#
defineComponent() {
    local deps iflags libs optional path libpaths builtin

    path="${1:-.}"
    iflags=-I`probe --name ejs.h --dir --search "$path:$path/src/deps/ejs:$path/src/include" "ejs.h"`
    libpaths=`probe --name libejs --dir --search "$path:$path/out/lib" "libejs" `
    if [ "$libpaths" = "" -a "$path" != "." ] ; then
        warnComponent ejs "Can't locate libejs"
        return
    fi
    optional="ssl"
    if [ "$BLD_STATIC" = 1 ] ; then
        optional="$optional sqlite"
    else
        if [ "$BLD_FEATURE_EJS_ALL_IN_ONE" = 1 ] ; then
            if isdefined SQLITE ; then
                optional="$optional sqlite"
            fi
        fi
    fi
    deps="mpr http"
    withlibs="$withlibs pcre"
    libs="$libs pcre"
    builtin=`[ $path = . ] && echo --builtin`

    configureComponent --libs "ejs $libs" --libpaths "$libpaths" --iflags "$iflags" --withlibs "$withlibs" $builtin \
        --dependencies "$deps" --optional-dependencies "$optional" ejs
}
